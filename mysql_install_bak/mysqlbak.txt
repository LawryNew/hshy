热备份：


安装 innobackupex

yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm && yum install percona-xtrabackup
innobackupex -version


备份：
--defaults-file=    --user  --password    /data/path


恢复
1.

2.

安装mysql

https://downloads.mysql.com/archives/community/
不要选 Redhat  选择系统 linuxGeneric 下载  tg包

groupadd mysql 
useradd -r -g mysql mysql
 chown -R mysql.mysql /usr/local/mysql
chmod 755  /usr/local/mysql/*



cp -r mysql-5.xxx   /usr/local/mysql  ####mysql文件夹没创建 所以复制过去自动改名


yum -y install autoconf
yum -y install perl perl-devel
 yum install -y libaio-devel


初始化

/usr/local/mysql/scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=/data/mysql_3306/data

创建日志：
mkdir -p /data/mysql_3306/logbin
touch /data/mysql_3306/{mysql-error.log,mysql-slow.log}
chown -R mysql.mysql   /data/mysql_3306/*
否则无法创建mysql-error.log  &  mysql.pid 报错 无法启动

启动进程
  nohup mysqld_safe --defaults-file=/etc/my_3306.cnf &
启动报错 看 nohup.out



链接改密码：

mysql -S /tmp/mysql_port.sock -uroot -p  
初始化无密码更改密码
update user set password=password('123456') where user = 'root';

恢复：

1.
innobackupex --apply-log /data/backup/2018-11-28_18-50-47/ 
####innobackupex --apply-log  /bakpath


2.
停掉mysql
备份 datadir后清空 
执行
innobackupex --defaults-file  --copy-back  /bakpath



主库创建复制用户，赋权限
rep  123456
记录 bin postion
mysql-bin.000002 | 442745645


从库：

change master to master_host='192.168.0.12', master_user='rep', master_password='123456', master_log_file='mysql-bin.000002', master_log_pos=442745645;
测试
用创建用户从库登录链接主库查看数据库 验证权限
没问题

start slave \G

两个yes 说明成功